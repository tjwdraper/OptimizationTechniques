function dx = grad_beale(x)
  dx(1,1) = 2*(1.500 - x(1) + x(1)*x(2))*(x(2)-1) ...
        + 2*(2.250 - x(1) + x(1)*x(2)^2)*(x(2)^2-1) ...
        + 2*(2.625 - x(1) + x(1)*x(2)^3)*(x(2)^3-1);
  dx(2,1) = 2*(1.500 - x(1) + x(1)*x(2))*x(1) ...
        + 2*(2.250 - x(1) + x(1)*x(2)^2)*2*x(1)*x(2) ...
        + 2*(2.625 - x(1) + x(1)*x(2)^3)*3*x(1)*x(2)^2;
endfunction

